{{ define "head" }}
<meta name="description" content="{{ .Params.description }}">
<link rel="stylesheet" href="{{.Site.Params.staticPath}}/css/list.css">

<!-- fontawesome -->
<script defer src="{{.Site.Params.staticPath}}/fontawesome-6/all-6.4.2.js"></script>
{{ end }}

{{ define "title" }}
{{.Title }} | {{ .Site.Title }}
{{ end }}

{{ define "main" }}

{{/* Collect unique tags */}}
{{ $allTags := slice }}
{{ range .RegularPages }}
  {{ range .Params.tags }}
    {{ $allTags = $allTags | append . }}
  {{ end }}
{{ end }}
{{ $allTags = $allTags | uniq | sort }}

<section id="portfolio">
  <h1 style="text-align:center; font-size:2rem; font-weight:bold; margin-bottom:1.5rem;">
    {{ .Title }}
  </h1>

  <!-- Filter buttons -->
  <div class="project-filters" style="text-align:center; margin-bottom:1rem;">
    <button class="filter-btn active" data-tag="All">All</button>
    {{ range $allTags }}
      <button class="filter-btn" data-tag="{{ . }}">{{ . }}</button>
    {{ end }}
  </div>

  {{ $projectsList := .RegularPages.ByDate.Reverse }}

  {{ partial "project-cards.html" (dict
    "projectsList" $projectsList
    "showCompanyName" true
    "cardHeight" (.Site.Params.portfolio.cardHeight | default 500)
    "cardImgHeight" (.Site.Params.portfolio.cardImgHeight | default 200)
    "excludeFolders" (.Site.Params.portfolio.excludeFolders | default "")
  ) }}

  {{ if .Site.Params.portfolio.enablepagination }}
  <!-- Pagination controls -->
  <div class="row justify-content-center mt-4">
    <div class="col-auto">
      <nav aria-label="Portfolio pagination">
        <ul class="pagination" id="portfolio-pagination">
          <!-- Generated by JavaScript -->
        </ul>
      </nav>
    </div>
  </div>
  {{ end }}

</section>

<!-- Portfolio configuration from Hugo params -->
<script>
  window.portfolioConfig = {
    paginationEnabled: {{ .Site.Params.portfolio.enablepagination }},
    itemsPerPage: {{ .Site.Params.portfolio.pagersize | default 8 }},
    maxCardHeight: {{ .Site.Params.portfolio.cardHeight | default 550 }}
  };
</script>

<!-- Portfolio filtering and pagination logic -->
<script src="{{.Site.Params.staticPath}}/js/portfolioList.js"></script>

{{ end }}

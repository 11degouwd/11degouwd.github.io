{{ if .Site.Params.experience.enable | default false }}

<link rel="stylesheet" href="{{ "css/experience.css" | relURL }}">

<section id="experience" class="py-5">
  <div class="container">
    <h3 class="text-center">
      {{ .Site.Params.experience.title | default "Experience" }} 
    </h3>

    <div class="row justify-content-center">
      <div class="col-sm-12 col-md-8 col-lg-8 py-5">
        <div class="experience-container px-3 pt-2">

          {{ $roles := where site.RegularPages "Section" "experience" }}
          <!-- {{ $roles = sort $roles "Params.start" "desc" }}  -->
          {{ $roles = sort $roles "Params.end" "asc" "Params.start" "desc" }}
          {{ $groups := $roles.GroupByParam "company_slug" }}
 
          {{ if gt (len $groups) 0 }}
          <div class="experience-container-loop">

            {{ range $groups }}
              {{ $company := site.GetPage (printf "companies/%s" .Key) }}

              <div class="experience-company">
                <div class="company-header">
                  <a class="company-logo-link" href="{{ $company.RelPermalink }}">
                    <img src="{{ $company.Params.logo | relURL }}" class="company-logo">
                  </a>
                  <div>
                    <h4 class="company-title">
                      <a href="{{ $company.RelPermalink }}">{{ $company.Title }}</a>
                    </h4>
                    <div class="company-dates">{{ $company.Params.start }} – {{ $company.Params.end | default "Present" }}</div>
                  </div>
                </div>

                <div class="roles-list">
                  {{ range .Pages }}
                    <div class="role-row">
                      <div class="role-dot"></div>
                      <div class="role-body"> 
                        <div class="role-title">{{ .Title }}</div>
                        <div class="role-meta">
                          {{ .Params.start | time.Format "Jan 2006" }} –
                          {{ with .Params.end }}{{ . | time.Format "Jan 2006" }}{{ else }}Present{{ end }}
                          {{ with .Params.location }} · {{ . }}{{ end }}
                        </div>
                        <p class="role-summary">{{ .Params.summary }}</p>
                      </div>
                    </div>
                  {{ end }}
                </div>
              </div>
            {{ end }}

          </div>
          {{ end }}

        </div>
      </div>
    </div>
  </div>
</section>
{{ end }}